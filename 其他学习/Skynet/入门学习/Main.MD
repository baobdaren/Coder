# skynet 入门

[参考博客1](https://blog.csdn.net/qq769651718/article/details/79432793)

## skynet介绍

基于C+Lua的开源服务端并发框架，单进程多线程Actor模型，轻量级游戏服务端框架。  

## 简介

每个服务都是严格的被动的消息驱动，以一个统一的callback函数提交给框架。框架从消息队列里调度出接受的模块，找到callback函数入口并调用。服务本身没有被调用时不消耗任何cpu。  

## 特点

Skynet做两个必要的保证  

1. 一个服务的callback函数永远不会被并发。  
2. 一个服务向另外一个服务发送的消息的次序是严格保证的  

skynet底层有一个消息队列，消息由三部分组成：源地址，目标地址，数据块。  
skynet启动多个线程，每个工作线程不断从消息队列取到消息，调用服务的callback函数。  

作为核心功能，skynet仅解决一个问题：  
把一个符合规范的C模块，从动态库（so文件）调用起来，绑定一个永不重复的id作为handle。模块被称为服务，服务间可以自由发送消息。每个模块可以向Skynet框架注册一个callback函数，用以接收消息。每个服务都是由消息包来驱动的，没有消息包到来时，他们就会处于挂起状态，对CPU资源零消耗。如果需要自主逻辑，可以使用skynet提供的timeout消息定期触发。  

## Actor模型

### Actor模型介绍

Actor模型内部由自己维护，即其内部数据只能由自己修改（通过消息传递来进行状态修改）。Actor由三部分组成：状态，行为，邮箱。  

1. 状态（state）：Acotr中的状态指的是Actor对象的变量信息，只能由自己修改，避免的并发环境下锁和内存原子性问题。  
2. 行为（behavior）：行为是指Actor中的计算逻辑，通过接收到消息来改变状态。  
3. 邮箱（mailbox）：邮箱是Actor之间通信的桥梁，邮箱内部通过FIFO消息队列来存储发送方Actor消息，接收方从队列中获取消息。  

Actor的基础就是消息传递，skynet中每个就是一个LUA虚拟机，就是一个Actor。  

### Actor模型好处

1. 事件模型驱动的非阻塞：
2. 数据仅由自己修改的强隔离性：
3. 邮箱功能获得的位置透明：
4. 轻量性：
 