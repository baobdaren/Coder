# 装箱和拆箱

## 装箱

就是将值类型变量转换成引用类型的变量

1. 在托管堆上分配内存，这比值类型要大。（类型对象指针和同步索引块）
2. 值类型的字段复制到新分配到堆内存中。
3. 返回堆内存上对象的地址。

## 拆箱

将被装箱的引用类型转换成值类型。注意拆箱不是装箱完全的逆过程，拆箱的代价要小很多。而且只有装箱过的对象才能被拆箱。

1. 严格意义上来说，拆箱只是获取指向堆上引用对象内指向值类型部分的指针。内容拷贝只有赋值时才发生。

## 其他-优化

装箱和拆箱都有性能损耗，应该尽量避免。  

1. 警惕隐式转换
2. 使用泛型-这样可以在运行时绑定数据类型。（C#泛型是在运行时替换）