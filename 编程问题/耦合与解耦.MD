# `耦合与解耦`

对于低耦合：一个完整的系统，模块与模块之间，尽可能使其独立存在。也就是说，尽可能让一个某块完成一个特定的子功能。模块与模块之间的接口，尽量少而简单。如果两个模块之间关系复杂，应该考虑进一步模块划分。这样有利于修改和组合。

耦合可以分为以下几种类型，耦合程度依次降低

* 内容耦合  
一个模块直接访问另外一个模块的内容，则称这两个模块内容耦合。
如以下情况：

  1. 一个模块直接访问另外一个模块的内部数据。
  2. 一个模块不通过正常的入口而直接转入另一个模块内部。
  3. 两个模块有一部分代码重叠。（该部分代码有一定了独立功能）
  4. 和模块欧多个入口  
    大多数高级语言都已经设计成不允许内容耦合

* 公共耦合
一组模块全部都访问同一个全局数据结构，称之为公共耦合。  
公共数据环境可以是全局数据结构，共享的通信区，内存的共覆盖区等。如果模块只是从公共数据环境取出，或只是写入，则成为松散的公共耦合。既写入也读取则称为紧密的公共耦合。
公共耦合会引起以下问题：

1. 难以控制各个模块对公共数据的存取，严重影响了软件模块的可靠性和适应性。
2. 使软件的可维护性变差，因一个模块修改了公共环境数据，也会影响其他模块。
3. 降低了代码的可理解性，很难确定哪些模块公用了哪些数据，排错困难。
一般的，仅当模块间需要传递的数据很多，而且通过参数传递不方便时。

* 外部耦合
一组模块都访问同一简单全局变量的，而且不通过参数表传递该全局变量的信息。

* 控制耦合
模块之间传递的不是数据信息，而是控制信息如开关，标志，一个模块控制了另一个模块的功能。

* 标记耦合
调用模块和被调用模块之间，传递的是数据结构而不是简单数据。也就是说传递的是指针或引用。

* 数据耦合
调用模块和被调用模块之间只传递简单的数据项参数。相当于高级语言中的值传递。

* 非直接耦合
两个模块之间没有直接关系，他们之间的联系完全是通过主模块的控制和调用来实现。

> 模块划分时，要遵循“一个模块，一个功能”的原则，尽可能使得模块达到功能内聚。  
> 模块间存在耦合时，应尽量使用数据耦合，少用控制耦合，慎用或有控制地使用公共耦合，并限制公共耦合的范围，尽量避免内容耦合。（数据耦合>控制耦合>公共耦合）
